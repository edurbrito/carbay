# EAP: Architecture Specification and Prototype

An online bidding platform destined for car model lovers, allowing them to sell or complete their private collections, by participating in real-time traditional auctions and interacting with other worldwide collectors.

## A7: High-level architecture. Privileges. Web resources specification

### 1. Overview

| Module | Description |
| ---- | ---- |
| M01: Authentication and Individual Profile | Web resources associated with user authentication and individual profile management, includes: login/logout, registration, password recovery, view and edit personal information. |
| M02: Auctions | Web resources associated with auctions, includes: auctions list and search, viewing details and creating new auctions, comments and bids. |
| M03: Favourites and Ratings | Web resources associated with favourite auctions and sellers, and also related to user ratings. It features actions like adding or removing an object from favourite, and giving a rating to an auction. |
| M04: Reports and Help Messages | Web resources associated with user reports and help messages. It features actions like reporting a given user or requesting admin help and listing all the help messages. |
| M05: User Administration and Static pages | Web resources associates with user management, specifically: view and search users and auctions, delete or suspend users and auctions, view and answer help messages, view and act on reports. Web resources with static content are associated with this module: Home Page, About Us, and FAQ. |

### 2. Permissions

| Type | Permission | Description |
| ---- | ---- | ---- |
| PUB |	Public | Users without privileges |
| USR |	User | Registered users |
| OWN |	Owner |	User that are owners of the information |
| ADM |	Administrator | Administrators |

### 3. OpenAPI Specification

```yaml
openapi: 3.0.0

info:
  version: '1.0'
  title: LBAW CarBay Web API
  description: Web Resources Specification (A7) for CarBay

servers:
- url: http://lbaw-prod.fe.up.pt
  description: Production server

externalDocs:
  description: Find more info here.
  url: https://git.fe.up.pt/lbaw/lbaw2021/lbaw2155/-/wikis/eap

tags:
  - name: 'M01: Authentication and Individual Profile'
  - name: 'M02: Auctions'
  - name: 'M03: Favourites and Ratings'
  - name: 'M04: Reports and Help Messages'
  - name: 'M05: User Administration and Static pages'

paths:

    /login:
        get:
          operationId: R101
          summary: 'R101: Login Form'
          description: 'Provide login form. Access: PUB'
          tags:
            - 'M01: Authentication and Individual Profile'
          responses:
            '200':
              description: 'Ok. Show [UI05](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2155/-/wikis/er#ui05-log-in)'
        post:
          operationId: R102
          summary: 'R102: Login Action'
          description: 'Processes the login form submission. Access: PUB'
          tags:
            - 'M01: Authentication and Individual Profile'
          requestBody:
            required: true
            content:
              application/x-www-form-urlencoded:
                schema:
                  type: object
                  properties:
                    email:          # <!--- form field name
                      type: string
                    password:    # <!--- form field name
                      type: string
                  required:
                    - email
                    - password

          responses:
            '302':
              description: 'Redirect after processing the login credentials.'
              headers:
                Location:
                  schema:
                    type: string
                  examples:
                    302Success:
                      description: 'Successful authentication. Redirect to search page.'
                      value: '/search'
                    302Error:
                      description: 'Failed authentication. Redirect to login form.'
                      value: '/login'
                  
    /logout:

        post:
          operationId: R103
          summary: 'R103: Logout Action'
          description: 'Logout the current authenticated user. Access: USR, ADM'
          tags:
            - 'M01: Authentication and Individual Profile'
          responses:
            '302':
              description: 'Redirect after processing logout.'
              headers:
                Location:
                  schema:
                    type: string
                  examples:
                    302Success:
                      description: 'Successful logout. Redirect to login form.'
                      value: '/homepage'
                      
    /signup:
        get:
          operationId: R104
          summary: 'R104: Signup Form'
          description: 'Provide new user signup form. Access: PUB'
          tags:
            - 'M01: Authentication and Individual Profile'
          responses:
            '200':
              description: 'Ok. Show [UI06](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2155/-/wikis/er#ui06-sign-up)'

        post:
          operationId: R105
          summary: 'R105: Signup Action'
          description: 'Processes the new user signup form submission. Access: PUB'
          tags:
            - 'M01: Authentication and Individual Profile'

          requestBody:
            required: true
            content:
              application/x-www-form-urlencoded:
                schema:
                  type: object
                  properties:
                    name:
                      type: string
                    username:
                      type: string
                    email:
                      type: string
                    password:
                      type: string
                  required:
                    - username
                    - name
                    - email
                    - password

          responses:
            '302':
              description: 'Redirect after processing the new user information.'
              headers:
                Location:
                  schema:
                    type: string
                  examples:
                    302Success:
                      description: 'Successful authentication. Redirect to search page.'
                      value: '/search'
                    302Failure:
                      description: 'Failed authentication. Redirect to signup form.'
                      value: '/signup'
                      
    /users/{id}:
        get:
          operationId: R106
          summary: 'R106: View user profile'
          description: 'Show the individual user profile. Access: PUB'
          tags:
            - 'M01: Authentication and Individual Profile'

          parameters:
            - in: path
              name: id
              schema:
                type: integer
              required: true

          responses:
            '200':
              description: 'Ok. Show [UI12](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2155/-/wikis/er#ui12-profile)'
 
```